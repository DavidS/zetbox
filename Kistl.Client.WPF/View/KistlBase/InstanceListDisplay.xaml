<UserControl x:Class="Kistl.Client.WPF.View.KistlBase.InstanceListDisplay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:tk="clr-namespace:Kistl.Client.WPF.View;assembly=Kistl.Client.WPF.Toolkit"
             xmlns:client="clr-namespace:Kistl.Client.WPF.View"
             xmlns:clientKistlBase="clr-namespace:Kistl.Client.WPF.View.KistlBase"
             xmlns:commands="clr-namespace:Kistl.Client.WPF.Commands;assembly=Kistl.Client.WPF.Toolkit"
             commands:SmartRoutedUICommand.IsCommandSink="True">
    <DockPanel>
        <GroupBox DockPanel.Dock="Top"
                  Header="Filter"
                  Padding="10"
                  Visibility="{Binding ShowFilter, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel>
                <ItemsControl ItemsSource="{Binding FilterViewModels}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <ContentPresenter Grid.Column="1"
                                              Content="{Binding}"
                                              ContentTemplateSelector="{StaticResource defaultTemplateSelector}" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>
        </GroupBox>

        <ToolBar DockPanel.Dock="Top"
                 ItemsSource="{Binding Commands}"
                 Visibility="{Binding ShowCommands, Converter={StaticResource BooleanToVisibilityConverter}}">
            <ToolBar.ItemTemplate>
                <DataTemplate>
                    <Button Command="{Binding Converter={StaticResource CommandConverter}}"
                            CommandParameter="{Binding DataContext.SelectedItems, RelativeSource={RelativeSource AncestorType={x:Type clientKistlBase:InstanceListDisplay}}}"
                            Content="{Binding Label}"
                            ToolTip="{Binding ToolTip}" />
                </DataTemplate>
            </ToolBar.ItemTemplate>
        </ToolBar>

        <GroupBox DockPanel.Dock="Bottom"
                  Visibility="{Binding ShowMasterDetail, Converter={StaticResource BooleanToVisibilityConverter}}"
                  Header="Details">
            <ContentPresenter Content="{Binding SelectedItem}"
                              tk:VisualTypeTemplateSelector.RequestedKind="{Binding RequestedEditorKind, Mode=OneWay}"
                              ContentTemplateSelector="{StaticResource defaultTemplateSelector}" />
        </GroupBox>

        <ListView x:Name="lst"
                  Margin="10"
                  BorderThickness="0"
                  ItemsSource="{Binding InstancesFiltered}"
                  ItemTemplateSelector="{StaticResource listItemTemplateSelector}"
                  SelectionChanged="lst_SelectionChanged"
                  GridViewColumnHeader.Click="ListView_HeaderClick">
            <ListView.Resources>
                <Style TargetType="ListViewItem">
                    <EventSetter Event="MouseDoubleClick"
                                 Handler="ObjectList_MouseDoubleClick" />
                </Style>
            </ListView.Resources>

        </ListView>
    </DockPanel>
</UserControl>
